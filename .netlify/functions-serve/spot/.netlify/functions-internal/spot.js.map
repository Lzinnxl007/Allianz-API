{
  "version": 3,
  "sources": ["../../../../Documents/RVINFO-Projects/Allianz-API/.netlify/functions-internal/spot.js", "../../../../Documents/RVINFO-Projects/Allianz-API/src/modules/SPOT/SPOT.service.js", "../../../../Documents/RVINFO-Projects/Allianz-API/src/modules/SPOT/SPOT.controller.js"],
  "sourceRoot": "C:/Users/User/AppData/Local/Temp/tmp-15592-40tThfSx79wa",
  "sourcesContent": ["import SPOTController from \"../../src/modules/SPOT/SPOT.controller.js\"\r\n\r\nexport const handler = async (event, context) => {\r\n    const data = await SPOTController.ManipulateProducts()\r\n  \r\n    return {\r\n      statusCode: 200,\r\n      body: JSON.stringify(data),\r\n    };\r\n  };", "\r\n\r\nclass SPOTService {\r\n  static async manipulateProducts(products) {\r\n    const token = await SPOTService.getToken()\r\n\r\n    const SPOTAllProducts = await SPOTService.getSpotProducts(token);\r\n    const productsStock = await SPOTService.getStock(token)\r\n\r\n    SPOTAllProducts?.forEach((product, index) => {\r\n      product.stock = productsStock?.[index].Quantity\r\n    })\r\n\r\n    const SPOTCodes = products?.map((product) => product.codigo);\r\n\r\n    const filteredSPOTProducts = SPOTService.filterSpotProducts(\r\n      SPOTAllProducts,\r\n      SPOTCodes\r\n    );\r\n\r\n    return filteredSPOTProducts\r\n    \r\n  }\r\n\r\n  static async getToken() {\r\n    try {\r\n      const tokenResponse = await fetch(\r\n        \"http://ws.spotgifts.com.br/api/v1/authenticateclient?AccessKey=dtFAe3tlWao8Q3rO\"\r\n      );\r\n\r\n      const data = await tokenResponse.json();\r\n      const token = data[\"Token\"];\r\n      return token;\r\n    } catch (error) {\r\n      if (error instanceof Error) {\r\n        console.log(error.message);\r\n      }\r\n      return;\r\n    }\r\n  }\r\n  static async getSpotProducts(token) {\r\n    try {\r\n      const productsResponse = await fetch(\r\n        `http://ws.spotgifts.com.br/api/v1/productsTree?token=${token}&lang=PT`\r\n      );\r\n\r\n      const products = await productsResponse.json();\r\n\r\n      return products.ProductsTree;\r\n    } catch (error) {\r\n      if (error instanceof Error) {\r\n        console.log(error.message);\r\n      }\r\n      return;\r\n    }\r\n  }\r\n\r\n  static async getStock(token) {\r\n    try {\r\n      const response = await fetch(\r\n        `http://ws.spotgifts.com.br/api/v1/stocks?token=${token}&lang=PT`\r\n      );\r\n      const stock = await response.json();\r\n      return stock.Stocks;\r\n    } catch (error) {\r\n      if (error instanceof Error) {\r\n        console.log(error.message);\r\n      }\r\n      return;\r\n    }\r\n  }\r\n\r\n  static filterSpotProducts(products, codes) {\r\n    const additionalData = products.map((product) => product.ProductOptionals);\r\n    products.forEach((product, index) => {\r\n      product.WebSku = additionalData[index][0].WebSku;\r\n      product.MainImage = `https://www.spotgifts.com.br/fotos/produtos/${product.MainImage}`;\r\n      product.Colors = product.ProductOptionals.map((optional) => optional.ColorDesc1).join(\" | \")\r\n      product.Price = product?.ScalePrices?.[0]?.Price\r\n      const imageList = product?.AllImageList?.split(\",\");\r\n      if (imageList.length > 4) {\r\n        imageList.length = 4;\r\n      }\r\n      const newImages = imageList?.map((url) => {\r\n        return `https://www.spotgifts.com.br/fotos/produtos/${url?.replace(\r\n          /\\s+/g,\r\n          \"\"\r\n        )}`;\r\n      });\r\n      product.AllImageList = newImages.join() ?? \"\";\r\n    });\r\n\r\n    return products.filter((product) => codes.includes(product.WebSku));\r\n  }\r\n}\r\n\r\nexport default SPOTService;\r\n", "import SPOTService from \"./SPOT.service.js\";\r\nimport fs from \"node:fs\"\r\n\r\nclass SPOTController {\r\n  static async ManipulateProducts() {\r\n    const file = fs.readFileSync(\"SPOTData.json\", \"utf-8\", (error) => {\r\n      if (error) {\r\n        console.log(error);\r\n        return null;\r\n      }\r\n    });\r\n    const products = JSON.parse(file);\r\n    const data = await SPOTService.manipulateProducts(products);\r\n    return data ?? []\r\n  }\r\n}\r\n\r\nexport default SPOTController;\r\n"],
  "mappings": "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",
  "names": ["fs"]
}
